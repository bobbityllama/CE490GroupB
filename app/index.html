<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <script src='/socket.io/socket.io.js'></script>
    <meta charset="utf-8">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 50%;
        width: 50%;
      }
      #screen {
        position: absolute;
        top: 0; right: 0; bottom: 0; left: 0;
      }
    </style>
  </head>
  <body>
    Lat: <input type="text" id="lat" value="-25.363">
    <br />
    Lon: <input type="text" id="lon" value="31.044">
    <input type="submit" id="submit">
    <br />
    Light: <input type="submit" id="test" value="on">

    <div id="map"></div>
    <script>
      function initMap() {
      var myLatLng = {lat: -25.363, lng: 31.044};

      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 2,
        center: myLatLng
      });

      var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: 'Hello World!'
      });

      document.getElementById("submit").addEventListener("click", function(event) {
        var lat = document.getElementById("lat").value;
        var lon = document.getElementById("lon").value;

        marker.setPosition( new google.maps.LatLng( lat, lon ) );
      });

      document.getElementById("test").addEventListener("click", function(event) {
        if(document.getElementById("test").value == "on")
        {
          socket.emit("lightoff");
          document.getElementById("test").value = "off";
        }
        else
        {
          socket.emit("lighton");
          document.getElementById("test").value = "on";
        }
        
      });
    }

    
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCVXj1vRXCYc3VIZtn0QsgcACaIdRhTIyU&callback=initMap"async defer></script>

  </body>

  <script>
  
  var socket = io();

  socket.on('high', function() {
    document.getElementById("submit").click();
  });

  socket.on('low', function() {
    document.getElementById("lat").value = -25.363;
    document.getElementById("lon").value = 31.044;
    document.getElementById("submit").click();
  });
  </script>
</html>